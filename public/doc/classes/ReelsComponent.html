<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>ReelsComponent - kingkong</title>
    <link rel="stylesheet" href="http://yui.yahooapis.com/3.8.0pr2/build/cssgrids/cssgrids-min.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <script src="http://yui.yahooapis.com/combo?3.8.0pr2/build/yui/yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
            <h1><a href="../index.html"><img src="../assets/css/kong-header.png" width="389" height="100">kingkong: ReelsComponent v0.3.4</a></h1>
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: 0.3.4</em>
        </div>
    </div>
    <div class="yui3-g">

        <div id="sidebar" class="yui3-u">
            <div id="modules" class="sidebox">
                <div class="hd">
                    <h2 class="no-toc">Modules</h2>
                </div>
                <div class="bd">
                    <ul>
                    </ul>
                </div>
            </div>
            
            <div id="classes" class="sidebox">
                <div class="hd">
                    <h2 class="no-toc">Classes</h2>
                </div>
                <div class="bd">
                    <ul>
                            <li><a href="../classes/BigWinComponent.html">BigWinComponent</a></li>
                            <li><a href="../classes/Command.html">Command</a></li>
                            <li><a href="../classes/CommandQueue.html">CommandQueue</a></li>
                            <li><a href="../classes/CustomCommand.html">CustomCommand</a></li>
                            <li><a href="../classes/Dj.html">Dj</a></li>
                            <li><a href="../classes/FireworksCommand.html">FireworksCommand</a></li>
                            <li><a href="../classes/G.BigWinCommand.html">G.BigWinCommand</a></li>
                            <li><a href="../classes/GaffeButton.html">GaffeButton</a></li>
                            <li><a href="../classes/GaffeMenuComponent.html">GaffeMenuComponent</a></li>
                            <li><a href="../classes/Game.html">Game</a></li>
                            <li><a href="../classes/GameComponent.html">GameComponent</a></li>
                            <li><a href="../classes/GameData.html">GameData</a></li>
                            <li><a href="../classes/Main.html">Main</a></li>
                            <li><a href="../classes/MeterComponent.html">MeterComponent</a></li>
                            <li><a href="../classes/ParticlesComponent.html">ParticlesComponent</a></li>
                            <li><a href="../classes/Preloader.html">Preloader</a></li>
                            <li><a href="../classes/QueueFactory.html">QueueFactory</a></li>
                            <li><a href="../classes/Reel.html">Reel</a></li>
                            <li><a href="../classes/ReelsComponent.html">ReelsComponent</a></li>
                            <li><a href="../classes/ServerInterface.html">ServerInterface</a></li>
                            <li><a href="../classes/SignalDispatcher.html">SignalDispatcher</a></li>
                            <li><a href="../classes/SpinEvaluator.html">SpinEvaluator</a></li>
                            <li><a href="../classes/SymbolAnimCommand.html">SymbolAnimCommand</a></li>
                            <li><a href="../classes/SymbolWinsComponent.html">SymbolWinsComponent</a></li>
                            <li><a href="../classes/Utils.html">Utils</a></li>
                            <li><a href="../classes/WinLine.html">WinLine</a></li>
                            <li><a href="../classes/WinLineCommand.html">WinLineCommand</a></li>
                            <li><a href="../classes/WinLinesComponent.html">WinLinesComponent</a></li>
                    </ul>
                </div>
            </div>
            
            <div id="methods-on-page" class="sidebox on-page">
                <div class="hd">
                    <h2 class="no-toc">Methods On Page</h2>
                </div>
                <div class="bd">
                    <ul>
                            <li><a href="#methods_drawReels">drawReels</a></li>
                            <li><a href="#methods_getInitialStrips">getInitialStrips</a></li>
                            <li><a href="#methods_handleGaffSpinRequest">handleGaffSpinRequest</a></li>
                            <li><a href="#methods_init">init</a></li>
                            <li><a href="#methods_modifySymbolData">modifySymbolData</a></li>
                            <li><a href="#methods_reelSpinEnd">reelSpinEnd</a></li>
                            <li><a href="#methods_requestSpin">requestSpin</a></li>
                            <li><a href="#methods_serverSpinStart">serverSpinStart</a></li>
                            <li><a href="#methods_slamSpin">slamSpin</a></li>
                            <li><a href="#methods_spinReels">spinReels</a></li>
                            <li><a href="#methods_updateSpinSpeed">updateSpinSpeed</a></li>
                    </ul>
                </div>
            </div>
            
            
            
            
            <div id="fileTree" class="sidebox">
                <div class="hd">
                    <h2 class="no-toc">Files</h2>
                </div>
                <div class="bd">
                    <ul><li>public/<ul><li>javascripts/<ul><li>app/<ul><li><a href="../files/public_javascripts_app_Main.js.html">Main.js</a></li><li>commands/<ul><li><a href="../files/public_javascripts_app_commands_BigWinCommand.js.html">BigWinCommand.js</a></li><li><a href="../files/public_javascripts_app_commands_Command.js.html">Command.js</a></li><li><a href="../files/public_javascripts_app_commands_CommandQueue.js.html">CommandQueue.js</a></li><li><a href="../files/public_javascripts_app_commands_CustomCommand.js.html">CustomCommand.js</a></li><li><a href="../files/public_javascripts_app_commands_FireworksCommand.js.html">FireworksCommand.js</a></li><li><a href="../files/public_javascripts_app_commands_RemoveBigWinCommand.js.html">RemoveBigWinCommand.js</a></li><li><a href="../files/public_javascripts_app_commands_SymbolAnimCommand.js.html">SymbolAnimCommand.js</a></li><li><a href="../files/public_javascripts_app_commands_WinLineCommand.js.html">WinLineCommand.js</a></li></ul></li><li>components/<ul><li><a href="../files/public_javascripts_app_components_BigWinComponent.js.html">BigWinComponent.js</a></li><li><a href="../files/public_javascripts_app_components_Dj.js.html">Dj.js</a></li><li><a href="../files/public_javascripts_app_components_GaffeButton.js.html">GaffeButton.js</a></li><li><a href="../files/public_javascripts_app_components_GaffeMenuComponent.js.html">GaffeMenuComponent.js</a></li><li><a href="../files/public_javascripts_app_components_GameComponent.js.html">GameComponent.js</a></li><li><a href="../files/public_javascripts_app_components_MeterComponent.js.html">MeterComponent.js</a></li><li><a href="../files/public_javascripts_app_components_ParticlesComponent.js.html">ParticlesComponent.js</a></li><li><a href="../files/public_javascripts_app_components_Reel.js.html">Reel.js</a></li><li><a href="../files/public_javascripts_app_components_ReelsComponent.js.html">ReelsComponent.js</a></li><li><a href="../files/public_javascripts_app_components_SymbolWinsComponent.js.html">SymbolWinsComponent.js</a></li><li><a href="../files/public_javascripts_app_components_WinLine.js.html">WinLine.js</a></li><li><a href="../files/public_javascripts_app_components_WinLinesComponent.js.html">WinLinesComponent.js</a></li></ul></li><li>core/<ul><li><a href="../files/public_javascripts_app_core_Game.js.html">Game.js</a></li><li><a href="../files/public_javascripts_app_core_GameData.js.html">GameData.js</a></li><li><a href="../files/public_javascripts_app_core_Preloader.js.html">Preloader.js</a></li><li><a href="../files/public_javascripts_app_core_ServerInterface.js.html">ServerInterface.js</a></li><li><a href="../files/public_javascripts_app_core_SignalDispatcher.js.html">SignalDispatcher.js</a></li><li><a href="../files/public_javascripts_app_core_SpinEvaluator.js.html">SpinEvaluator.js</a></li></ul></li><li>utils/<ul><li><a href="../files/public_javascripts_app_utils_QueueFactory.js.html">QueueFactory.js</a></li><li><a href="../files/public_javascripts_app_utils_Utils.js.html">Utils.js</a></li></ul></li></ul></li></ul></li></ul></li></ul>
                </div>
            </div>
            
        </div>

        <div id="main" class="yui3-u">
            <div class="content"><h4>Class ReelsComponent</h4>
    Extends: G.GameComponent<br>
<span class="foundat">Class defined in: <a href="../files/public_javascripts_app_components_ReelsComponent.js.html#l9"><code>public&#x2F;javascripts&#x2F;app&#x2F;components&#x2F;ReelsComponent.js:9</code></a></span>
<div class="intro"><p>GameComponent responsible for creating the G.Reels (ReelStrips) drawing symbols to each reel and launching the spin animation on them.
This class makes spinRequests via the serverInterface, and handles the responses by updating the reels according the to the
stops array.
It also dispatches a signalDispatcher.reelSpinComplete signal when all reel animations have completed</p>
</div>

    <a name="methods_ReelsComponent"></a>
    <div class="method item">
         <strong class="name"><code>ReelsComponent</code></strong>( <code>  </code> ) 
        <br>
        <span class="foundat">
            
            <a href="../files/public_javascripts_app_components_ReelsComponent.js.html#l9"><code>public&#x2F;javascripts&#x2F;app&#x2F;components&#x2F;ReelsComponent.js:9</code></a>
        </span><br>
        
    </div>

<div id="classdocs">
    <ul>
        <li><a href="#methods">Methods</a></li>
        <li><a href="#props">Properties</a></li>
    </ul>
    <div>
            <div id="methods">
<a name="methods_drawReels"></a>
<div class="method item">
     <strong class="name"><code>drawReels</code></strong>( <code>  </code> ) 
    <br>
    <span class="foundat">
        
        <a href="../files/public_javascripts_app_components_ReelsComponent.js.html#l168"><code>public&#x2F;javascripts&#x2F;app&#x2F;components&#x2F;ReelsComponent.js:168</code></a>
    </span><br>
    <p>Creates and initialises each reelstrip, and draws them to the display.</p>

</div>
<a name="methods_getInitialStrips"></a>
<div class="method item">
    Array <strong class="name"><code>getInitialStrips</code></strong>( <code>reelStrips </code> ) 
    <br>
    <span class="foundat">
        
        <a href="../files/public_javascripts_app_components_ReelsComponent.js.html#l125"><code>public&#x2F;javascripts&#x2F;app&#x2F;components&#x2F;ReelsComponent.js:125</code></a>
    </span><br>
    <p>This function is necessary because the reelStrips arrays are so large, the spin animation cannot cope with animating such a
large amount of symbols in one strip without serious lag (I&#39;ve tried it!)
(It&#39;s possible a blitted approach may get around this issue)
For now the initial reelStrips are made up of n symbols cut from the reelStrips array during initialisation (n = setup.json variable cutLength)
So we just take a slice from the initial stop value of the array and return the new reelStrips 2d array which we&#39;ll use to draw the reel symbols from.</p>

    <strong>Parameters:</strong>
    <ul class="params">
        <li>
            <code>reelStrips</code> <strong>&lt;Object&gt;</strong>
         
        </li>
    </ul>
    <br><div class="returns"><strong>Returns:</strong> &lt;Array&gt; </div>
</div>
<a name="methods_handleGaffSpinRequest"></a>
<div class="method item">
     <strong class="name"><code>handleGaffSpinRequest</code></strong>( <code>requestUrl </code> ) 
    <br>
    <span class="foundat">
        
        <a href="../files/public_javascripts_app_components_ReelsComponent.js.html#l187"><code>public&#x2F;javascripts&#x2F;app&#x2F;components&#x2F;ReelsComponent.js:187</code></a>
    </span><br>
    <p>Gaffe spin requests handled by reelsComponent so that it knows a spin has been requested.
Calls ServerInterface to make an api request for the gaffe (requestUrl)</p>

    <strong>Parameters:</strong>
    <ul class="params">
        <li>
            <code>requestUrl</code> <strong>&lt;Object&gt;</strong>
         
        </li>
    </ul>
</div>
<a name="methods_init"></a>
<div class="method item">
     <strong class="name"><code>init</code></strong>( <code>setup, signalDispatcher, serverInterface, symbolSprites, slotInitResponse </code> ) 
    <br>
    <span class="foundat">
        
        <a href="../files/public_javascripts_app_components_ReelsComponent.js.html#l106"><code>public&#x2F;javascripts&#x2F;app&#x2F;components&#x2F;ReelsComponent.js:106</code></a>
    </span><br>
    <p>initialises the reelsComponent with required game data and assets</p>

    <strong>Parameters:</strong>
    <ul class="params">
        <li>
            <code>setup</code> <strong>&lt;Object&gt;</strong>
        <ul>
<li>the setup json data object</li>
</ul>

        </li>
        <li>
            <code>signalDispatcher</code> <strong>&lt;G.SignalDispatcher&gt;</strong>
        <ul>
<li>game&#39;s signal dispatcher used to dispatch signals to the rest of the application</li>
</ul>

        </li>
        <li>
            <code>serverInterface</code> <strong>&lt;G.ServerInterface&gt;</strong>
        <ul>
<li>reference to the game&#39;s server interface required to make the spin request</li>
</ul>

        </li>
        <li>
            <code>symbolSprites</code> <strong>&lt;Object&gt;</strong>
        <ul>
<li>the createjs spritesheet data object required to pass to the createjs.SpriteSheet constructor</li>
</ul>

        </li>
        <li>
            <code>slotInitResponse</code> <strong>&lt;Object&gt;</strong>
        <ul>
<li>the slot init response from the server.</li>
</ul>

        </li>
    </ul>
</div>
<a name="methods_modifySymbolData"></a>
<div class="method item">
     <strong class="name"><code>modifySymbolData</code></strong>( <code>reelData, reset </code> ) 
    <br>
    <span class="foundat">
        
        <a href="../files/public_javascripts_app_components_ReelsComponent.js.html#l147"><code>public&#x2F;javascripts&#x2F;app&#x2F;components&#x2F;ReelsComponent.js:147</code></a>
    </span><br>
    <p>Takes an array of symbol ID&#39;s and passes them to each reel to modify symbol sprites at runtime on each reel
This is usually only done when the spin request server response has returned the stop positions, but can also be used
for calling and debugging win animations.</p>

    <strong>Parameters:</strong>
    <ul class="params">
        <li>
            <code>reelData</code> <strong>&lt;Number&gt;</strong>
         
        </li>
        <li>
            <code>reset</code> <strong>&lt;Boolean&gt;</strong>
         
        </li>
    </ul>
</div>
<a name="methods_reelSpinEnd"></a>
<div class="method item">
     <strong class="name"><code>reelSpinEnd</code></strong>( <code>  </code> ) 
    <br>
    <span class="foundat">
        
        <a href="../files/public_javascripts_app_components_ReelsComponent.js.html#l384"><code>public&#x2F;javascripts&#x2F;app&#x2F;components&#x2F;ReelsComponent.js:384</code></a>
    </span><br>
    <p>Signal handler called when reel.reelSpinEnd is dispatched.  When all reels have finished
this method dispatches the signalDispatcher.reelSpinComplete signal.</p>

</div>
<a name="methods_requestSpin"></a>
<div class="method item">
     <strong class="name"><code>requestSpin</code></strong>( <code>  </code> ) 
    <br>
    <span class="foundat">
        
        <a href="../files/public_javascripts_app_components_ReelsComponent.js.html#l199"><code>public&#x2F;javascripts&#x2F;app&#x2F;components&#x2F;ReelsComponent.js:199</code></a>
    </span><br>
    <p>requestSpin is called every time the user initiates a spin (either via the keyboard or swipe to spin gesture on touch devices)
If spinRequest has not yet been made (ie the reels are stopped) then this makes a serverInterface.requestSpin call, and the spinRequest flag
is set to true.
Otherwise we slam the reels to stop them.</p>

</div>
<a name="methods_serverSpinStart"></a>
<div class="method item">
     <strong class="name"><code>serverSpinStart</code></strong>( <code>spinResponse </code> ) 
    <br>
    <span class="foundat">
        
        <a href="../files/public_javascripts_app_components_ReelsComponent.js.html#l221"><code>public&#x2F;javascripts&#x2F;app&#x2F;components&#x2F;ReelsComponent.js:221</code></a>
    </span><br>
    <p>Reel Animations start here: configuration options are in setup.reelAnimation</p>
<ul>
<li><ol>
<li>By default 10 symbols after and including the symbol at the stopIndex of the reelStrip are cut from the reelStrips array</li>
</ol>
</li>
<li><ol>
<li>Existing symbols on the reels are switched to those symbols.  Switching takes place off the visible canvas after the first spin cycle,
to give the existing symbols time to animate from the reels.</li>
</ol>
</li>
<li><ol>
<li>If a symbolIndex in the reelStrip array equals the replacementId defined in the setup.json then a replacement is made based on the spinResponse.</li>
</ol>
</li>
<li><ol>
<li>Starts the reels spinning and passes the correct symbol index to stop to
See (G.Reel) for more info about how reel strips are drawn and animated.</li>
</ol>
</li>
</ul>

    <strong>Parameters:</strong>
    <ul class="params">
        <li>
            <code>spinResponse</code> <strong>&lt;Object&gt;</strong>
        <ul>
<li>the spin response containing the spinRecords and stops array</li>
</ul>

        </li>
    </ul>
</div>
<a name="methods_slamSpin"></a>
<div class="method item">
     <strong class="name"><code>slamSpin</code></strong>( <code>  </code> ) 
    <br>
    <span class="foundat">
        
        <a href="../files/public_javascripts_app_components_ReelsComponent.js.html#l361"><code>public&#x2F;javascripts&#x2F;app&#x2F;components&#x2F;ReelsComponent.js:361</code></a>
    </span><br>
    <p>Schedules the reels to stop immediately</p>

</div>
<a name="methods_spinReels"></a>
<div class="method item">
     <strong class="name"><code>spinReels</code></strong>( <code>  </code> ) 
    <br>
    <span class="foundat">
        
        <a href="../files/public_javascripts_app_components_ReelsComponent.js.html#l315"><code>public&#x2F;javascripts&#x2F;app&#x2F;components&#x2F;ReelsComponent.js:315</code></a>
    </span><br>
    <p>Spins all reels with a delay configuration from setup.json
Stops reels if they are currently spinning.
Clear any winline/animation overlays
Play Spin Sound</p>

</div>
<a name="methods_updateSpinSpeed"></a>
<div class="method item">
     <strong class="name"><code>updateSpinSpeed</code></strong>( <code>val </code> ) 
    <br>
    <span class="foundat">
        
        <a href="../files/public_javascripts_app_components_ReelsComponent.js.html#l398"><code>public&#x2F;javascripts&#x2F;app&#x2F;components&#x2F;ReelsComponent.js:398</code></a>
    </span><br>
    <p>For debugging purposes, provides a hook to update Reels&#39; spinSpeed</p>

    <strong>Parameters:</strong>
    <ul class="params">
        <li>
            <code>val</code> <strong>&lt;Number&gt;</strong>
         
        </li>
    </ul>
</div>
            </div>
            <div id="props">
                <a name="props_reelMap"></a>
                <div class="props item">
                    <code>reelMap</code> &lt;<strong>Object</strong>&gt;<br>
                    <span class="foundat"><a href="../files/public_javascripts_app_components_ReelsComponent.js.html#l54"><code>public&#x2F;javascripts&#x2F;app&#x2F;components&#x2F;ReelsComponent.js:54</code></a></span>
                    <p>Setup contains a map array of all the symbol names. eg. &#39;ww&#39;, &#39;m1&#39;. These are stored in the array at the index of the symbolId.
                That way we can draw the correct symbols according to reelStrips data array, which is an array of symbolIds.</p>
                
                </div>
                <a name="props_reels"></a>
                <div class="props item">
                    <code>reels</code> &lt;<strong>G.Reel</strong>&gt;<br>
                    <span class="foundat"><a href="../files/public_javascripts_app_components_ReelsComponent.js.html#l46"><code>public&#x2F;javascripts&#x2F;app&#x2F;components&#x2F;ReelsComponent.js:46</code></a></span>
                    <p>Container for the G.Reel sub components, 1 per reel.</p>
                
                </div>
                <a name="props_reelsData"></a>
                <div class="props item">
                    <code>reelsData</code> &lt;<strong>Null</strong>&gt;<br>
                    <span class="foundat"><a href="../files/public_javascripts_app_components_ReelsComponent.js.html#l36"><code>public&#x2F;javascripts&#x2F;app&#x2F;components&#x2F;ReelsComponent.js:36</code></a></span>
                    <p>These are the default symbols drawn to the reels.
                This may need to be created from the slotInit response at some point.</p>
                
                </div>
                <a name="props_reelsSpinning"></a>
                <div class="props item">
                    <code>reelsSpinning</code> &lt;<strong>Number</strong>&gt;<br>
                    <span class="foundat"><a href="../files/public_javascripts_app_components_ReelsComponent.js.html#l64"><code>public&#x2F;javascripts&#x2F;app&#x2F;components&#x2F;ReelsComponent.js:64</code></a></span>
                    <p>Keeps a count of the number of reels which are currenlty animating.  When a reel dispatches it&#39;s complete signal, this number is
                reduced.  When the number of reels spinning becomes 0 this component can fire it&#39;s reelsSpinComplete signal via the signalDispatcher.</p>
                
                </div>
                <a name="props_serverInterface"></a>
                <div class="props item">
                    <code>serverInterface</code> &lt;<strong>G.ServerInterface</strong>&gt;<br>
                    <span class="foundat"><a href="../files/public_javascripts_app_components_ReelsComponent.js.html#l82"><code>public&#x2F;javascripts&#x2F;app&#x2F;components&#x2F;ReelsComponent.js:82</code></a></span>
                    <p>The ServerInterface is required here to make spin Requests.</p>
                
                </div>
                <a name="props_slotInit"></a>
                <div class="props item">
                    <code>slotInit</code> &lt;<strong>Null</strong>&gt;<br>
                    <span class="foundat"><a href="../files/public_javascripts_app_components_ReelsComponent.js.html#l99"><code>public&#x2F;javascripts&#x2F;app&#x2F;components&#x2F;ReelsComponent.js:99</code></a></span>
                    
                </div>
                <a name="props_spinRequested"></a>
                <div class="props item">
                    <code>spinRequested</code> &lt;<strong>Boolean</strong>&gt;<br>
                    <span class="foundat"><a href="../files/public_javascripts_app_components_ReelsComponent.js.html#l73"><code>public&#x2F;javascripts&#x2F;app&#x2F;components&#x2F;ReelsComponent.js:73</code></a></span>
                    <p>If a spinRequest has been made to the server we do not want to make another spin request.  Instead, we would like
                to hammer the reels to stop.</p>
                
                </div>
                <a name="props_symbolSprites"></a>
                <div class="props item">
                    <code>symbolSprites</code> &lt;<strong>Object</strong>&gt;<br>
                    <span class="foundat"><a href="../files/public_javascripts_app_components_ReelsComponent.js.html#l27"><code>public&#x2F;javascripts&#x2F;app&#x2F;components&#x2F;ReelsComponent.js:27</code></a></span>
                    <p>the createjs spritesheet data object required to pass to the createjs.SpriteSheet constructor in order to draw the symbols.
                This is passed from Game during initialisation.</p>
                
                </div>
            </div>
    </div>
</div>
</div>
        </div>
    </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>
<script src="../assets/js/tabs.js"></script>
</body>
</html>
