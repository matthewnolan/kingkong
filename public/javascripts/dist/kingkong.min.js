/*! kingkong 0.0.6 - 2015-02-08
* Copyright (c) 2015 Licensed @HighFiveGames */
var G=G||{};!function(){"use strict";var a=function(){},b=a.prototype;b.constructor=a,b.loopIndex=0,b.callNextDelay=2e3,b.init=function(){},b.execute=function(){},G.Command=a}();var G=G||{};!function(){"use strict";var a=function(){},b=a.prototype;b.constructor=a,b.setup=null,b.queue=[],b.timeout=null,b.shouldLoop=!1,b.loopReturnIndex=0,b.queueFactory=null,b.currentIndex=0,b.init=function(a){this.setup=a,this.queueFactory=new G.QueueFactory,this.queueFactory.init()},b.setupQueue=function(){throw"not implemented"},b.play=function(){var a=this.queue.length;a&&this.executeNext(this.queue[this.currentIndex])},b.executeNext=function(a){a.execute(),a.loopIndex&&(this.loopReturnIndex=a.loopIndex),this.currentIndex++===this.queue.length-1&&(this.shouldLoop?this.currentIndex=0:this.flushQueue()),this.timeout=setTimeout(this.executeNext,a.callNextDelay)},b.stop=function(){throw"not implemented"},b.flushQueue=function(){this.queue=[],window.clearTimeout(this.timeout)},G.CommandQueue=a}(),this.G=this.G||{},function(){"use strict";var a=function(){},b=a.prototype;b.constructor=a,b.setup=null,b.serverInterface=null,b.stage=null,b.assets=null,b.init=function(a,b){this.serverInterface=b,this.stage=a;var c=new G.Preloader;c.init(this,this.SETUP_URL),c.setupComplete.add(this.onSetupLoaded,this),c.assetsLoaded.add(this.onAssetsLoadComplete,this),c.startLoad()},b.onSetupLoaded=function(a){this.setup=a},b.onAssetsLoadComplete=function(a){this.assets=a,this.setupDisplay(),this.initUIEvents()},b.setupDisplay=function(){var a=this.setup.bezelMarginL,b=this.setup.bezelMarginT,c=this.setup.bezelW,d=this.setup.bezelH,e=new createjs.SpriteSheet(this.assets.spriteSheetStatics),f=new createjs.Sprite(e,"ui-bezel");this.stage.addChild(f),this.reelsComponent=new G.ReelsComponent,this.reelsComponent.init(this.setup,e),this.reelsComponent.drawReels(),this.reelsComponent.x=a,this.reelsComponent.y=b,this.stage.addChild(this.reelsComponent);var g=new createjs.Shape;g.graphics.setStrokeStyle(0).drawRect(a,b,c,d).closePath(),this.stage.addChild(g),this.setup.devMode||(this.reelsComponent.mask=g)},b.initUIEvents=function(){var a=this;window.document.onkeydown=function(b){switch(b.keyCode){case 32:case 0:a.reelsComponent.spinReels()}},createjs.Touch.enable(this.stage);var b=document.querySelector("#app"),c=new Hammer(b);c.get("swipe").set({direction:Hammer.DIRECTION_ALL}),c.get("pinch").set({enable:!0}),c.on("swipe",function(){a.reelsComponent.spinReels()}),c.on("pinchin",function(){}),c.on("pinchout",function(){}),this.setup.domHelpers||$(".dom-helpers").remove()},G.Game=a}(),this.G=this.G||{},function(){"use strict";var a=function(){},b=a.prototype;b.constructor=a,b.stats=null,b.stage=null,b.game=null,b.init=function(){this.stats=new Stats,this.stats.setMode(0),this.stats.domElement.style.position="absolute",this.stats.domElement.style.bottom="0px",this.stats.domElement.style.left="0px",document.body.appendChild(this.stats.domElement);var a=667,b=375,c=.75;this.stage=new createjs.Stage("app"),this.stage.scaleX=c,this.stage.scaleY=c;var d=document.querySelector("#app");d.setAttribute("width",(a*c).toString()+"px"),d.setAttribute("height",(b*c).toString()+"px"),createjs.Ticker.on("tick",this.handleTick,this),createjs.Ticker.setFPS(60);var e=new G.ServerInterface;e.init(),this.game=new G.Game,this.game.init(this.stage,e)},b.handleTick=function(){this.stats.begin(),this.stage.update(),this.stats.end()},G.Main=a}(),this.G=this.G||{},function(){"use strict";var a=function(){},b=a.prototype;b.constructor=a,b.SETUP_URL="assets/config/setup.json",b.game=null,b.setupLoader=null,b.assetsLoader=null,b.spriteSheetBigWin=null,b.spriteSheetStatics=null,b.spriteSheetSymbolAnims=null,b.setupComplete=new signals.Signal,b.assetsLoaded=new signals.Signal,b.init=function(a){this.game=a,this.setupLoader=new createjs.LoadQueue(!0),this.setupLoader.on("fileload",this.handleSetupLoaded,this),this.assetsLoader=new createjs.LoadQueue(!0),this.assetsLoader.on("error",this.handleAssetsError,this),this.assetsLoader.on("progress",this.handleAssetsProgress,this),this.assetsLoader.on("complete",this.handleAssetsLoaded,this)},b.startLoad=function(){this.setupLoader.loadFile(this.SETUP_URL)},b.handleSetupLoaded=function(a){this.setupComplete.dispatch(a.result),this.loadGameAssets()},b.loadGameAssets=function(){this.assetsLoader.loadManifest(this.game.setup.spritesManifest)},b.handleAssetsError=function(){},b.handleAssetsProgress=function(){},b.handleAssetsLoaded=function(){var a={spriteSheetBigWin:this.assetsLoader.getResult("bigWinAnim"),spriteSheetStatics:this.assetsLoader.getResult("staticImages"),spriteSheetSymbolAnims:this.assetsLoader.getResult("symbolAnims")};this.assetsLoaded.dispatch(a)},G.Preloader=a}();var G=G||{};!function(){"use strict";var a=function(){},b=a.prototype;b.constructor=a,b.init=function(){},G.QueueFactory=a}();var G=G||{};!function(){"use strict";var a=function(){this.Container_constructor()},b=createjs.extend(a,createjs.Container);b.constructor=a,b.reelData=[],b.setup=null,b.symbolSprites=null,b.containers={main:this,wraps:[]},b.scheduleSpinStop=-2,b.speedPercentage=.5,b.speedConstant=6e3,b.spriteMap=["ww","m1","m2","m3","m4","f5","f6","f7","f8","f9","f0","d1","d2","d3","d4","b1","b2"],b.tween=null,b.scheduleSpeedChange=!1,b.reelSpinEnd=new signals.Signal,b.stopTimeout=0,b.spinResultIndex=null,b.init=function(a,b,c){this.setup=a,this.symbolSprites=b,this.reelData=c},b.getTime=function(){var a=this.setup.symbolH,b=this.setup.symbolMarginBottom,c=this.reelData.length,d=a*c+b*c,e=d/(this.speedPercentage*this.speedConstant/1e3);return e},b.getStopTime=function(a){var b=this.setup.symbolH,c=this.setup.symbolMarginBottom,d=this.reelData.length,e=b*a+c*a+(b*d+c*d),f=e/(this.speedPercentage*this.speedConstant/1e3);return f},b.drawReel=function(){var a,b,c,d=this.setup.symbolH,e=this.setup.symbolMarginBottom;for(a=0;2>a;a++){var f=new createjs.Container;for(this.addChild(f),b=0;b<this.reelData.length;b++)c=new createjs.Sprite(this.symbolSprites,this.spriteMap[this.reelData[b]]),f.addChild(c),c.y=d*b+e*b;f.y=-a*(d*this.reelData.length+e*this.reelData.length),this.containers.wraps.push(f)}},b.spinInfinite=function(a,b){var c=this,d=this.setup.symbolH,e=this.setup.symbolMarginBottom,f=this.reelData.length;this.spinResultIndex=b,this.scheduleSpinStop=-1;var g=d*f+e*f;createjs.Tween.get(this).wait(a).play(createjs.Tween.get(this,{loop:!1,paused:!0}).to({y:g},this.getTime(),createjs.Ease.getElasticIn(2,5)).call(this.loopSpin)),this.stopTimeout=setTimeout(function(){c.fastStop()},this.setup.reelAnimation.duration+a)},b.loopSpin=function(){var a,b,c=this.setup.symbolH,d=this.setup.symbolMarginBottom,e=this.reelData.length;-1===this.scheduleSpinStop&&(this.y=0,a=c*e+d*e,b=createjs.Ease.linear(),createjs.Tween.get(this,{override:!0,loop:!1}).to({y:a},this.getTime(),b).call(this.loopSpin))},b.stopSpin=function(a){this.scheduleSpinStop=-2;var b=this.setup.symbolH,c=this.setup.symbolMarginBottom,d=this.reelData.length,e=b*a+c*a+(b*d+c*d);this.y=0,createjs.Tween.get(this,{override:!0,loop:!1}).to({y:e},this.getStopTime(a),createjs.Ease.getElasticOut(2,5)).call(this.handleSpinComplete)},b.fastStop=function(){this.scheduleSpinStop>-2&&(clearInterval(this.stopTimeout),this.stopSpin(this.spinResultIndex))},b.handleSpinComplete=function(){console.log("handleSpinComplte"),this.reelSpinEnd.dispatch()},b.spinSpeedIncrement=function(a){this.speedPercentage!==a&&(this.speedPercentage=a,this.scheduleSpeedChange=!0)},G.Reel=createjs.promote(a,"Container")}();var G=G||{};!function(){"use strict";var a=function(){this.Container_constructor()},b=createjs.extend(a,createjs.Container);b.constructor=a,b.symbolSprites=null,b.setup=null,b.reelsData=[[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16],[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16],[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16],[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16],[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16]],b.reels=[],b.reelMap=null,b.reelsSpinning=0,b.init=function(a,b){this.setup=a,this.symbolSprites=b,this.reelsMap=a.reelMap,this.initDomEvents(),a.reelAnimation.shuffleReels&&this.shuffleReels()},b.shuffleReels=function(){var a,b=this.reelsData.length;for(a=0;b>a;a++)this.shuffle(this.reelsData[a])},b.shuffle=function(a){for(var b,c,d=a.length;0!==d;)c=Math.floor(Math.random()*d),d-=1,b=a[d],a[d]=a[c],a[c]=b;return a},b.drawReels=function(){var a,b,c=this.reelsData.length,d=this.setup.symbolW,e=this.setup.reelMarginRight;for(a=0;c>a;a++)b=new G.Reel,b.init(this.setup,this.symbolSprites,this.reelsData[a]),this.addChild(b),b.drawReel(),this.reels.push(b),b.x=d*a+e*a},b.spinReels=function(){console.log("spinReels");var a,b,c,d=this,e=this.reels.length,f=this.setup.reelAnimation.delay.max,g=function(a){return d.setup.reelAnimation.delay.random===!0?Math.random()*f:d.setup.reelAnimation.delay.sequenced===!0?f/d.reels.length*a:void 0};if(0===this.reelsSpinning)for(a=0;e>a;a++)c=g(a),b=this.reels[a],b.spinInfinite(c,-2),b.reelSpinEnd.add(this.reelSpinEnd,this),this.reelsSpinning++;else for(a=0;e>a;a++)b=this.reels[a],b.fastStop()},b.updateSpinSpeed=function(a){var b,c,d=this.reels.length;for(b=0;d>b;b++)c=this.reels[b],c.spinSpeedIncrement(a/100)},b.reelSpinEnd=function(){console.log("this.reelsSpinning=",this.reelsSpinning),0===--this.reelsSpinning&&console.log("REEL ANIM COMPLETE")},b.initDomEvents=function(){var a=this;$("#gasPedal").on("input",function(b){var c=$(b.target).val();a.updateSpinSpeed(c)})},G.ReelsComponent=createjs.promote(a,"Container")}(),this.G=this.G||{},function(){"use strict";var a=function(){},b=a.prototype;b.constructor=a,b.init=function(){},G.ServerInterface=a}();var G=G||{};!function(){"use strict";var a=function(){this.Container_constructor()},b=createjs.extend(a,createjs.Container);b.constructor=a,b.winLineSquares=[0,0,0,0,0],b.symbolLocations=[1,1,1,1,1],b.init=function(a,b){this.winLineSquares=a,this.symbolLocations=b},b.draw=function(){},G.WinLine=createjs.promote(a,"Container")}();var G=G||{};!function(){"use strict";var a=function(){this.Container_constructor()},b=createjs.extend(a,createjs.Container);b.constructor=a,b.init=function(){},G.WinLinesComponent=createjs.promote(a,"Container")}();